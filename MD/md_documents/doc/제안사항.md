# 프로젝트 기술 제안사항

본 문서는 `GEMINI.md` 및 프로젝트 전반의 코드를 분석한 결과를 바탕으로, 시스템의 안정성, 보안, 확장성을 향상시키기 위한 기술적인 제안사항을 정리한 것입니다.

## 1. API 키 보안 강화 (가장 중요)

*   **현황 및 문제점**:
    *   `GEMINI.md` 파일에 실제 투자 및 모의 투자 API 키가 직접 포함되어 있습니다.
    *   Git과 같은 버전 관리 시스템에 API 키가 포함되면, 저장소가 외부에 노출될 경우 심각한 보안 사고로 이어질 수 있습니다.

*   **제안**:
    1.  **즉시 조치**: `GEMINI.md`에서 API 키를 즉시 제거하고, Git 히스토리에서도 해당 내용을 삭제하는 것을 강력히 권장합니다.
    2.  **안전한 보관 방법**: API 키와 같은 모든 민감 정보는 `config.ini` 파일에 저장합니다.
    3.  **Git 관리**: **`config.ini` 파일을 `.gitignore`에 추가하여 Git 저장소에 포함되지 않도록 설정합니다.** 이렇게 하면 민감한 정보가 코드와 함께 외부에 유출되는 것을 원천적으로 방지할 수 있습니다. 서버에는 `config.ini` 파일을 직접 업로드하여 사용하고, 팀원 간에는 암호화된 채널 등 안전한 방법으로 공유합니다.

## 2. 백엔드 프로세스 관리 개선

*   **현황 및 문제점**:
    *   현재 `nohup python3 app.py &` 명령어를 사용하여 백엔드 Flask 서버를 실행하고 있습니다.
    *   이 방식은 간단하지만, 서버가 재시작되거나 예기치 않은 오류로 프로세스가 종료될 경우 자동으로 복구되지 않아 서비스 중단으로 이어질 수 있습니다.

*   **제안**:
    *   **Gunicorn + Systemd 도입**:
        *   **Gunicorn**: Python WSGI HTTP 서버로, Flask 애플리케이션을 보다 안정적이고 효율적으로 실행할 수 있게 해줍니다. 여러 워커 프로세스를 두어 동시 요청 처리 성능을 높일 수 있습니다.
        *   **Systemd**: 리눅스 시스템의 표준 서비스 관리자로, Gunicorn으로 실행되는 Flask 앱을 서비스로 등록합니다.
    *   **기대 효과**:
        *   **자동 재시작**: 서버 부팅 시 자동으로 애플리케이션이 실행됩니다.
        *   **프로세스 복구**: 오류로 인해 앱이 비정상 종료될 경우, Systemd가 이를 감지하고 자동으로 재시작하여 서비스 다운타임을 최소화합니다.
        *   **표준화된 관리**: `systemctl start|stop|restart|status stock-autotrade.service` 와 같은 표준 명령어로 서비스를 쉽게 관리할 수 있습니다.
*   **적용 방법**:
    1.  `doc/stock-autotrade.service` 파일을 시스템의 서비스 디렉토리로 복사합니다. (sudo 권한 필요)
        ```bash
        sudo cp /home/stock/public_html/doc/stock-autotrade.service /etc/systemd/system/
        ```
    2.  Systemd가 새 서비스 파일을 인식하도록 리로드합니다.
        ```bash
        sudo systemctl daemon-reload
        ```
    3.  서비스를 활성화하여 부팅 시 자동으로 시작되도록 설정합니다.
        ```bash
        sudo systemctl enable stock-autotrade.service
        ```
    4.  서비스를 시작합니다.
        ```bash
        sudo systemctl start stock-autotrade.service
        ```
    5.  서비스 상태를 확인합니다.
        ```bash
        sudo systemctl status stock-autotrade.service
        ```

## 3. 데이터 저장 방식 개선 (DB 도입)

*   **현황 및 문제점**:
    *   계좌 정보, 매매 내역, 분석 데이터 등 주요 데이터를 다수의 JSON 파일 (`kiwoom_data.json` 등)에 저장하고 있습니다.
    *   **동시 접근 문제**: 여러 요청이나 프로세스가 동시에 파일에 쓰려고 할 때 데이터가 손상될(깨질) 위험이 있습니다 (Race Condition).
    *   **데이터 조회 및 분석의 한계**: 특정 조건(예: 특정 기간의 매매 내역)의 데이터를 검색하거나 집계하는 작업이 복잡하고 비효율적입니다.
    *   **성능 및 확장성**: 데이터가 많아질수록 파일 I/O로 인한 성능 저하가 발생하며, 대용량 데이터를 관리하기 어렵습니다.

*   **제안**:
    *   **데이터베이스(DB) 도입**: 매매 내역, 계좌 상태 로그, 분석 데이터 등 정형화된 데이터는 데이터베이스에 저장하는 것을 강력히 권장합니다.
        *   **SQLite**: 별도의 서버 설치 없이 파일 기반으로 동작하여 가볍고 빠르게 시작하기에 매우 좋습니다. 프로젝트 초기 단계나 단일 서버 환경에 적합합니다.
        *   **MySQL / PostgreSQL**: 더 많은 동시 요청 처리와 대용량 데이터 관리가 필요할 경우 적합한 관계형 데이터베이스입니다.
    *   **기대 효과**:
        *   **데이터 무결성**: 트랜잭션 기능을 통해 데이터의 일관성과 안정성을 보장합니다.
        *   **효율적인 데이터 관리**: SQL을 사용하여 복잡한 조건의 데이터를 빠르고 쉽게 조회, 수정, 삭제, 집계할 수 있습니다.
        *   **성능 향상**: 최적화된 인덱싱과 쿼리 실행으로 대용량 데이터에서도 높은 성능을 유지합니다.

## 4. 실시간 업데이트를 위한 WebSocket 도입 고려

*   **현황 및 문제점**:
    *   현재 웹 대시보드(`index.php`)는 JavaScript의 `setInterval`을 사용하여 주기적으로(Polling) API를 호출하여 데이터를 갱신합니다.
    *   이 방식은 구현이 간단하지만, 데이터 변경이 없을 때도 불필요한 HTTP 요청을 계속 보내 서버에 부하를 줍니다. 또한, 실시간성이 중요한 데이터(예: 현재가, 매매 체결)를 즉각적으로 반영하기 어렵습니다.

*   **제안**:
    *   **WebSocket 도입**: 실시간 데이터 통신이 필요한 기능(예: 실시간 매매 현황, 계좌 정보 업데이트)에 WebSocket을 도입하는 것을 고려해볼 수 있습니다.
    *   **동작 방식**: 클라이언트(웹 브라우저)와 서버 간에 지속적인 연결을 열어두고, 서버에서 데이터 변경이 발생했을 때 즉시 클라이언트로 데이터를 밀어주는(Push) 방식입니다.
    *   **기대 효과**:
        *   **진정한 실시간성**: 데이터가 발생하는 즉시 사용자 화면에 반영되어 사용자 경험이 크게 향상됩니다.
        *   **서버 부하 감소**: 불필요한 폴링 요청이 사라져 서버와 네트워크 자원을 효율적으로 사용할 수 있습니다.
        *   **양방향 통신**: 클라이언트와 서버가 언제든지 서로에게 메시지를 보낼 수 있어 더 동적인 애플리케이션 구현이 가능합니다.

전문 트레이딩 대시보드의 느낌을 살려달라는 요청합니다. 전문 트레이더의 화면은 화려함보다는 정보의 밀도, 가독성, 그리고 빠른 상황 판단에 중점을 둡니다.

이러한 철학을 바탕으로, 기존 index.php의 디자인을 다음과 같이 개선하는 것을 제안 합니다.

주요 개선 방향
다크 모드 (Dark Theme) 적용: 장시간 모니터링 시 눈의 피로를 줄이고, 데이터에 집중할 수 있도록 고대비 다크 테마를 적용
대시보드 레이아웃 (CSS Grid): 기존의 수직적 구조에서 벗어나, CSS Grid를 사용해 여러 정보 패널을 한눈에 볼 수 있는 대시보드 형태로 재구성
카드(Card) UI 도입: 각 정보 단위(계좌 요약, 보유 종목 등)를 '카드' 형태로 명확히 구분하여 시각적으로 정돈되고 전문적인 느낌을 주도록
핵심 지표 강조: 총 평가 손익, 수익률과 같은 중요한 숫자들은 색상(녹색/적색)과 가독성 좋은 폰트를 사용해 즉각적으로 인지할 수 있도록 강조
불필요한 요소 제거: "시스템 초기화 중..."과 같은 장식적인 요소를 제거하고, 사용자가 바로 데이터에 집중할 수 있도록 페이지를 간결하게

작업도중 멈춤으로 계속 진행해야할 내용
✦ us_stock_analyzer.py는 FMP API나 백업 파일에서 상승률 상위 종목을 가져와
  yfinance로 상세 정보를 얻은 후 us_top_gainers_info_and_news.json에
  저장합니다. us_top_gainers_scraper.py가 이미 데이터베이스에 상위 종목을
  저장하므로, us_stock_analyzer.py가 FMP나 백업 파일 대신 데이터베이스를
  사용하도록 수정해야 합니다.

  계획:

   1. `us_stock_analyzer.py` 수정:
      a. database.py에서 get_db_connection을 가져옵니다.
      b. us_top_gainers 테이블에서 상위 종목을 읽는 get_top_gainers_from_db()
  함수를 새로 만듭니다.
      c. if __name__ == "__main__": 블록에서 get_top_gainers_from_db()를
  호출하여 티커 목록을 가져옵니다.
      d. yfinance 정보 가져오기 및 us_top_gainers_info_and_news.json 파일
  생성은 유지하되, 섹터와 산업 정보는 데이터베이스에도 저장합니다.

   2. `database.py` 수정:
      a. us_top_gainers 테이블에 sector와 industry 열을 추가합니다.
      b. 주식별 뉴스를 저장할 news 테이블을 추가합니다.

  먼저 database.py를 수정하여 us_top_gainers 테이블에 sector와 industry 열을
  추가하고 us_stock_news 테이블을 생성하겠습니다. us_top_gainers 테이블이
  이미 존재하므로 ALTER TABLE을 사용하여 열을 추가해야 합니다. database.py를
  수정하여 테이블 변경을 처리하겠습니다.
 ╭───────────────────────────────────────────────────────────────────────────╮
 │ ✔  WriteFile Writing to database.py                                       │
 │                                                                           │
 │    ... first 8 lines hidden ...                                           │
 │    17   +     try:                                                        │
 │    18   +         # us_top_gainers 테이블에 sector, industry 컬럼         │
 │           추가                                                            │
 │    19   +         cursor.execute("PRAGMA                                  │
 │           table_info(us_top_gainers)")                                    │
 │    20   +         columns = [row[1] for row in cursor.fetchall()]         │
 │    21   +         if 'sector' not in columns:                             │
 │    22   +             cursor.execute("ALTER TABLE us_top_gainers          │
 │           ADD COLUMN sector TEXT")                                        │
 │    23   +             print("us_top_gainers 테이블에 'sector'             │
 │           컬럼을 추가했습니다.")                                          │
 │    24   +         if 'industry' not in columns:                           │
 │    25   +             cursor.execute("ALTER TABLE us_top_gainers          │
 │           ADD COLUMN industry TEXT")                                      │
 │    26   +             print("us_top_gainers 테이블에 'industry'           │
 │           컬럼을 추가했습니다.")                                          │
 │    27   +                                                                 │
 │    28   +         # us_top_gainers 테이블의 symbol 컬럼에 UNIQUE          │
 │           제약 조건 추가 (주의: 데이터가 이미 있다면 복잡함)              │
 │    29   +         # 여기서는 간단히 넘어가지만, 실제 운영에서는           │
 │           데이터 마이그레이션 필요                                        │
 │    30   +                                                                 │
 │    31   +     except sqlite3.OperationalError as e:                       │
 │    32   +         print(f"데이터베이스 업그레이드 중 오류 발생:           │
 │           {e}")                                                           │
 │    33   +                                                                 │
 │    34   +     conn.commit()                                               │
 │    35   +     conn.close()                                                │
 │    36   +                                                                 │
 │    37     def init_db():                                                  │
 │    38         """데이터베이스를 초기화하고 테이블을 생성합니다."""        │
 │    14   -     if os.path.exists(DB_FILE):                                 │
 │    15   -         print("데이터베이스가 이미 존재합니다.")                │
 │    16   -         return                                                  │
 │    17   -                                                                 │
 │    18   -     print("데이터베이스를 초기화합니다...")                     │
 │    ═══════════════════════════════════════════════════════════════        │
 │    39         conn = get_db_connection()                                  │
 │    40         cursor = conn.cursor()                                      │
 │    41                                                                     │
 │    44         CREATE TABLE IF NOT EXISTS us_top_gainers (                 │
 │    45             id INTEGER PRIMARY KEY AUTOINCREMENT,                   │
 │    46             rank INTEGER,                                           │
 │    27   -         symbol TEXT,                                            │
 │    ═══════════════════════════════════════════════════════════════        │
 │    47   +         symbol TEXT UNIQUE,                                     │
 │    48             name TEXT,                                              │
 │    49             price TEXT,                                             │
 │    50             change_amount TEXT,                                     │
 │    52             volume TEXT,                                            │
 │    53             market_cap TEXT,                                        │
 │    54             pe_ratio TEXT,                                          │
 │    55   +         sector TEXT,                                            │
 │    56   +         industry TEXT,                                          │
 │    57             retrieved_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP        │
 │    58         )                                                           │
 │    59         ''')                                                        │
 │    60                                                                     │
 │    61   +     # 미국 주식 뉴스                                            │
 │    62   +     cursor.execute('''                                          │
 │    63   +     CREATE TABLE IF NOT EXISTS us_stock_news (                  │
 │    64   +         id INTEGER PRIMARY KEY AUTOINCREMENT,                   │
 │    65   +         symbol TEXT,                                            │
 │    66   +         title TEXT,                                             │
 │    67   +         link TEXT,                                              │
 │    68   +         publisher TEXT,                                         │
 │    69   +         provider_publish_time TIMESTAMP,                        │
 │    70   +         retrieved_at TIMESTAMP DEFAULT                          │
 │           CURRENT_TIMESTAMP,                                              │
 │    71   +         FOREIGN KEY (symbol) REFERENCES us_top_gainers          │
 │           (symbol)                                                        │
 │    72   +     )                                                           │
 │    73   +     ''')                                                        │
 │    74   +                                                                 │
 │    75         # 국내 주식 정보                                            │
 │    76         cursor.execute('''                                          │
 │    77         CREATE TABLE IF NOT EXISTS korean_stock_info (              │
 │    ═══════════════════════════════════════════════════════════════        │
 │    100                                                                    │
 │    101        conn.commit()                                               │
 │    102        conn.close()                                                │
 │    67   -     print("데이터베이스 초기화 완료.")                          │
 │    ═══════════════════════════════════════════════════════════════        │
 │    103  +     print("데이터베이스 테이블 구조를 확인 및                   │
 │           생성했습니다.")                                                 │
 │    104                                                                    │
 │    105    if __name__ == '__main__':                                      │
 │    106        init_db()                                                   │
 │    107  +     upgrade_db()                                                │
 │    108  +     print("데이터베이스 초기화 및 업그레이드 완료.")            │
 ╰───────────────────────────────────────────────────────────────────────────╯
✦ database.py를 스키마 업그레이드를 처리하도록 업데이트했으니, 이제 실행하여
  us_top_gainers 테이블에 새 열을 추가하고 us_stock_news 테이블을
  생성하겠습니다.
 ╭─────────────────────────────────────────────────────────────────────╮
 │ ✔  Shell python3 database.py (Upgrade the database schema.)         │
 │                                                                     │
 │    데이터베이스 테이블 구조를 확인 및 생성했습니다.                 │
 │    us_top_gainers 테이블에 'sector' 컬럼을 추가했습니다.            │
 │    us_top_gainers 테이블에 'industry' 컬럼을 추가했습니다.          │
 │    데이터베이스 초기화 및 업그레이드 완료.                          │
 │                                                                     │
 ╰─────────────────────────────────────────────────────────────────────╯
✦ 데이터베이스 스키마가 업데이트되었습니다. 이제 us_stock_analyzer.py가
  데이터베이스를 사용하도록 수정하겠습니다. 계획은 다음과 같습니다: 1.
  us_stock_analyzer.py를 읽습니다. 2. us_top_gainers 테이블에서 상승률 상위
  종목을 읽어오도록 수정합니다. 3. yfinance를 사용하여 각 종목의 섹터, 산업,
  뉴스를 가져옵니다. 4. us_top_gainers 테이블에 섹터와 산업 정보를
  업데이트합니다. 5. us_stock_news 테이블에 뉴스를 삽입합니다. 6. 중복되는 FMP
  API 로직은 제거합니다. 먼저 파일을 읽는 것부터 시작하겠습니다.
 ╭───────────────────────────────────╮
 │ ✔  ReadFile us_stock_analyzer.py  │
 ╰───────────────────────────────────╯
✦ us_stock_analyzer.py 내용을 확인했습니다. 이제 데이터베이스를 사용하도록
  수정하겠습니다.

  다음은 새 스크립트 버전입니다.

   ... first 26 lines hidden ...
    25             })
    26
    27         return {
    28             'ticker': ticker,
    29             'sector': sector,
    30             'industry': industry,
    31             'news': news_list
    32         }
    33     except Exception as e:
    34         print(f"정보 및 뉴스를 가져오는 중 오류 발생 ({ticker}):
       {e}")
    35         return None
    36
    37 def get_top_gainers_from_db():
    38     """
    39     데이터베이스에서 상위 등락률 종목 티커를 가져옵니다.
    40     """
    41     conn = get_db_connection()
    42     cursor = conn.cursor()
    43     cursor.execute("SELECT symbol FROM us_top_gainers")
    44     rows = cursor.fetchall()
    45     conn.close()
    46     return [row['symbol'] for row in rows]
    47
    48 def save_stock_info_to_db(info_and_news):
    49     """
    50     yfinance에서 가져온 종목 정보를 데이터베이스에 업데이트하고
       뉴스를 저장합니다.
    51     """
    52     if not info_and_news:
    53         return
    54
    55     conn = get_db_connection()
    56     cursor = conn.cursor()
    57
    58     # sector 및 industry 정보 업데이트
    59     cursor.execute("""
    60         UPDATE us_top_gainers
    61         SET sector = ?, industry = ?
    62         WHERE symbol = ?
    63     """, (info_and_news['sector'], info_and_news['industry'],
       info_and_news['ticker']))
    64
    65     # 기존 뉴스 삭제
    66     cursor.execute("DELETE FROM us_stock_news WHERE symbol = ?",
       (info_and_news['ticker'],))
    67
    68     # 새 뉴스 삽입
    69     for news_item in info_and_news['news']:
    70         cursor.execute("""
    71             INSERT INTO us_stock_news (symbol, title, link,
       publisher, provider_publish_time)
    72             VALUES (?, ?, ?, ?, ?)
    73         """, (
    74             info_and_news['ticker'],
    75             news_item['title'],
    76             news_item['link'],
    77             news_item['publisher'],
    78             news_item['providerPublishTime']
    79         ))
    80
    81     conn.commit()
    82     conn.close()
    83
    84 if __name__ == "__main__":
    85     print("\n--- 데이터베이스에서 상위 등락률 종목 수집 시작 ---"
       )
    86     top_gainers_tickers = get_top_gainers_from_db()
    87
    88     if not top_gainers_tickers:
    89         print("데이터베이스에 상위 등락률 종목이 없습니다.
       us_top_gainers_scraper.py를 먼저 실행하세요.")
    90     else:
    91         print(f"데이터베이스에서 {len(top_gainers_tickers)}개의
       상위 등락률 종목을 가져왔습니다.")
    92
    93         all_top_gainers_info = []
    94         print("\n--- 상위 등락률 종목 정보 및 뉴스 수집 시작
       (yfinance) ---")
    95         for ticker in top_gainers_tickers:
    96             info_and_news = get_stock_info_and_news(ticker)
    97             if info_and_news:
    98                 all_top_gainers_info.append(info_and_news)
    99                 save_stock_info_to_db(info_and_news)
   100                 print(f"  -> {ticker} 정보 및 뉴스 수집 및 저장
       완료.")
   101             else:
   102                 print(f"  -> {ticker} 정보 및 뉴스 수집 실패.")
   103
   104         # korean_stock_finder.py와의 호환성을 위해 JSON 파일도
       생성
   105         output_filename_info_news =
       'us_top_gainers_info_and_news.json'
   106         with open(output_filename_info_news, 'w', encoding=
       'utf-8') as f:
   107             json.dump(all_top_gainers_info, f, ensure_ascii=False
       , indent=4)
   108         print(f"\n모든 상위 등락률 종목 정보 및 뉴스가 '
       {output_filename_info_news}' 에 저장되었습니다.")

  이제 이 새 버전을 us_stock_analyzer.py에 쓰겠습니다.
 ╭─────────────────────────────────────────────────────────────────────╮
 │ ✔  WriteFile Writing to us_stock_analyzer.py                        │
 │                                                                     │
 │    ... first 174 lines hidden ...                                   │
 │    73   +         """, (                                            │
 │    74   +             info_and_news['ticker'],                      │
 │    75   +             news_item['title'],                           │
 │    76   +             news_item['link'],                            │
 │    77   +             news_item['publisher'],                       │
 │    78   +             news_item['providerPublishTime']              │
 │    79   +         ))                                                │
 │    80                                                               │
 │    ═══════════════════════════════════════════════════════════════  │
 │    121  -     all_top_gainers_info = []                             │
 │    81   +     conn.commit()                                         │
 │    82   +     conn.close()                                          │
 │    83                                                               │
 │    ═══════════════════════════════════════════════════════════════  │
 │    123  -     print("\n--- 상위 등락률 종목 정보 및 뉴스 수집 시작  │
 │           (yfinance) ---")                                          │
 │    84   + if __name__ == "__main__":                                │
 │    85   +     print("\n--- 데이터베이스에서 상위 등락률 종목 수집   │
 │           시작 ---")                                                │
 │    86   +     top_gainers_tickers = get_top_gainers_from_db()       │
 │    87   +                                                           │
 │    88         if not top_gainers_tickers:                           │
 │    ═══════════════════════════════════════════════════════════════  │
 │    125  -         print("수집할 상위 등락률 종목이 없습니다.")      │
 │    89   +         print("데이터베이스에 상위 등락률 종목이          │
 │           없습니다. us_top_gainers_scraper.py를 먼저 실행하세요.")  │
 │    90         else:                                                 │
 │    91   +         print(f"데이터베이스에서                          │
 │           {len(top_gainers_tickers)}개의 상위 등락률 종목을         │
 │           가져왔습니다.")                                           │
 │    92   +                                                           │
 │    93   +         all_top_gainers_info = []                         │
 │    94   +         print("\n--- 상위 등락률 종목 정보 및 뉴스 수집   │
 │           시작 (yfinance) ---")                                     │
 │    95             for ticker in top_gainers_tickers:                │
 │    96                 info_and_news =                               │
 │           get_stock_info_and_news(ticker)                           │
 │    97                 if info_and_news:                             │
 │    98                                                               │
 │           all_top_gainers_info.append(info_and_news)                │
 │    ═══════════════════════════════════════════════════════════════  │
 │    131  -                 print(f"  -> {ticker} 정보 및 뉴스 수집   │
 │           완료.")                                                   │
 │    99   +                 save_stock_info_to_db(info_and_news)      │
 │    100  +                 print(f"  -> {ticker} 정보 및 뉴스 수집   │
 │           및 저장 완료.")                                           │
 │    101                else:                                         │
 │    102                    print(f"  -> {ticker} 정보 및 뉴스 수집   │
 │           실패.")                                                   │
 │    103                                                              │
 │    104  +         # korean_stock_finder.py와의 호환성을 위해 JSON   │
 │           파일도 생성                                               │
 │    105            output_filename_info_news =                       │
 │           'us_top_gainers_info_and_news.json'                       │
 │    106            with open(output_filename_info_news, 'w',         │
 │           encoding='utf-8') as f:                                   │
 │    107                json.dump(all_top_gainers_info, f,            │
 │           ensure_ascii=False, indent=4)                             │
 │    108            print(f"\n모든 상위 등락률 종목 정보 및 뉴스가    │
 │           '{output_filename_info_news}' 에 저장되었습니다.")        │
 │    ═══════════════════════════════════════════════════════════════  │
 │    139  -                                                           │
 │    140  -     # 기존 yfinance 테스트 예시 유지 (선택 사항)          │
 │    141  -     print("\n--- yfinance 개별 종목 데이터 테스트 (AAPL)  │
 │           ---")                                                     │
 │    142  -     aapl_data = get_us_stock_data("AAPL", period="1mo",   │
 │           interval="1d")                                            │
 │    143  -     if aapl_data:                                         │
 │    144  -         print(f"AAPL 데이터 ({len(aapl_data)}개):")       │
 │    145  -         output_filename_aapl = 'us_stock_data_AAPL.json'  │
 │    146  -         with open(output_filename_aapl, 'w',              │
 │           encoding='utf-8') as f:                                   │
 │    147  -             json.dump(aapl_data, f, ensure_ascii=False,   │
 │           indent=4)                                                 │
 │    148  -         print(f"AAPL 데이터가 '{output_filename_aapl}'    │
 │           에 저장되었습니다.")                                      │
 │    149  -                                                           │
 │    150  -     print("\n--- yfinance 개별 종목 데이터 테스트 (MSFT)  │
 │           ---")                                                     │
 │    151  -     msft_data = get_us_stock_data("MSFT", period="5d",    │
 │           interval="1h")                                            │
 │    152  -     if msft_data:                                         │
 │    153  -         print(f"MSFT 데이터 ({len(msft_data)}개):")       │
 │    154  -         output_filename_msft = 'us_stock_data_MSFT.json'  │
 │    155  -         with open(output_filename_msft, 'w',              │
 │           encoding='utf-8') as f:                                   │
 │    156  -             json.dump(msft_data, f, ensure_ascii=False,   │
 │           indent=4)                                                 │
 │    157  -         print(f"MSFT 데이터가 '{output_filename_msft}'    │
 │           에 저장되었습니다.")                                      │
 ╰─────────────────────────────────────────────────────────────────────╯