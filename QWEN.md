주식 자동매매 시스템 개발 계획 (QWEN.md)

모든 작업을 하기전 Git 서버에 저장된 내용을 확인 하고 진행한다.
기능이 새로 작성되거나 업데이트되면 웹페이지 index.php와 연결되어야 한다.
웹페이지에서 '메인 페이지로 가기' 버튼을 고정 위치로 변경하여 스크롤하더라도 항상 보이도록 한다.
MD 폴더 안에 있는 파일들은 참고용으로 사용하여 본 프로젝트에 적용한다.
작업이 완료되면 Git 서버에 저장하고 README.md를 업데이트 한다.

작동하지 않은 페이지 : 
- http://stock.mizrino.com/display_all_stocks.php
- http://stock.mizrino.com/display_technical_analysis.php 종목을 검색하면 해당 결과물이 나오지 않음
- http://stock.mizrino.com/view_stock_chart.php 실 데이터와 괴리가 있음 문제점을 찾아야함.


1. 프로젝트 개요 및 목표
본 프로젝트는 키움증권 REST API를 활용하여 주식 자동매매 시스템을 구축하는 것을 목표로 합니다. 핵심 목표는 손실 최소화 및 수익 최대화이며, 이를 위해 Python 기반의 자동매매 로직과 PHP 기반의 웹 인터페이스를 연동하여 실시간 모니터링 및 제어 기능을 제공합니다.
작업 내용 저장: 지금까지 작업한 내용을 저장하는 파일 및 폴더 구조 관리.
사용 설명서 파일: 사용설명서 저장
웹서치를 최대한 자제한다.

2. 기술 스택
자동매매 로직: Python (pyheroapi 라이브러리 활용)

웹 인터페이스: PHP, HTML, CSS, JavaScript

API 연동: 키움증권 REST API

데이터베이스: MySQL (필요한 데이터 저장)
데이터베이스에는 기본적으로 APP_KEY, APP_SECRET가 저장되어 있다.


3. 주요 기능 및 개발 내용
본 프로젝트는 `pyheroapi` 라이브러리를 활용하여 키움증권 REST API와의 연동을 효율적으로 처리하고, 다양한 주식 데이터를 수집 및 분석합니다.
3.1. 자동매매 로직 (Python)
매매 시간 관리:

정규 자동매매 시간: 09:00 ~ 15:00 (급등주 매매시간 초과 종목 포함)

급등주 매매 시간: 09:00 ~ 09:20

미국 주식 분석:

웹 스크래핑이 차단되어 `yfinance` 라이브러리를 사용하는 것으로 대체.

**[대안 제시]**
*   **무료 주식 데이터 API 사용**: `yfinance`(Yahoo Finance)나 `Alpha Vantage` 같은 라이브러리/API를 사용하면 웹 스크래핑보다 훨씬 안정적으로 데이터를 가져올 수 있습니다.
*   **다른 금융 웹사이트 스크래핑**: Investing.com 대신 스크래핑이 비교적 쉬운 다른 사이트(예: Yahoo Finance)를 대상으로 시도해 볼 수 있습니다.

**[추천]**
`yfinance` 라이브러리 사용을 강력하게 추천. 사용법이 간단하고 필요한 주식 데이터를 안정적으로 얻을 수 있어 프로젝트에 매우 적합합니다.


상위 30위 종목의 테마 및 뉴스 검색 (외부 API 또는 웹 스크래핑).
- 진행중
-- python_modules/get_top_30_rising_stocks.py  (장중 확인 할것)
- 상승률 상위 30위 종목 및 관련 종목의 테마/뉴스 표시 (완료 현시점에서 시간외 종목까지 적용됨 이는 페이지을 로딩할시 적용됨)

국내 주식 분석:
1. 이동평균선을 이용한 분석 : 5일 이평선, 10일 이평선을 4일 이상 이탈하지 않은 종목 검색
2. 급등주 검색: 전일 거래량 대비 50% 이상 상승한 종목 검색
3. md_documents 폴더에 있는 '급등주거래량.txt' 파일을 참고하여 거래량 법칙 적용
5. md_documents 폴더에 있는 '거래량 법칙.txt' 파일을 참고하여 거래량 법칙 적용
6. md_documents 폴더에 있는 '호가창 매매법.txt' 파일을 참고하여 호가창 매매법 적용
7. md_documents 폴더에 있는 '5일선 타법.txt' 파일을 참고하여 5일선 타법 적용


미국 주식 테마와 연관된 국내 주식 종목 검색.

관심종목 '피봇일목거래량돌파' 데이터 활용.

국내 주식 테마 및 종목 관련 뉴스 검색.

차트 데이터 수집 및 분석:

키움증권 REST API를 이용하여 검색된 종목의 일봉 차트 및 분봉 차트 데이터 불러오기.

일봉/분봉 차트 데이터 기반으로 종목명, 시가, 유통주식수, 테마를 목록화.

급등주 검색 (09:00 ~ 09:03):

전일 거래량 대비 50% 이상 상승한 종목 검색.

매매 전략:

일봉 차트 기준: 5일(또는 10일) 이동평균선을 4거래일 이상 이탈하지 않은 종목 우선 고려.

급등주 매매:

당일 전일 대비 거래량 100% 이상 상승 종목 대상.

매도 물량 분석: 매도 물량이 1~2틱 위 물량 (3틱부터 10틱까지 합한 물량)이 매수 물량 대비 약 2배 이상인 경우에만 매수/매도 진행.

모의 투자 연동:

모의 투자 계좌를 통한 시스템 테스트 및 검증.

자금 관리:

총 매수 금액: 1,000,000원.

한 종목당 최대 매수 금액: 100,000원.

손절 및 익절 설정:

매수 가격 대비 -2% 하락 시 자동 매도.

매수된 종목이 3% 이상 상승 후, 상승한 상태에서 -2% 하락 시 자동 매도.

3.2. 웹 인터페이스 (PHP)
자동매매 제어 기능:

자동매매 시작, 일시정지, 중지 버튼 구현.

차트 및 종목 정보 표시:

일봉 차트 화면 표시.

1분봉 차트 화면 표시.

미국 주식 상승률 상위 30위 종목, 테마, 뉴스 표시.

국내 주식 5일선 및 10일선 유지 종목 표시.

급등주 종목명 및 테마 표시.

매매 현황 표시:

실시간 매매 현황 (매수/매도 내역, 수익률 등) 표시.

손실(매도) 설정 기능:

사용자가 손실 매도 기준을 설정할 수 있는 기능 추가 (예: -2% 설정값 변경).

실시간 데이터 갱신:

모든 웹 화면의 데이터 자동 갱신.

국내 주식 실시간 상위 종목 (종목명, 상승률, 거래량, 테마, 뉴스) 데이터 업데이트 및 표시.

참고 문서 :
급등주거래량.txt
거래량 법칙.txt
키움 REST API 문서.pdf
호가창 매매법.txt
5일선 타법.txt

4. API 정보
API 키는 `config.ini` 파일에서 관리합니다. `.gitignore`에 등록되어 있으므로 해당 파일을 직접 확인해야 합니다.

5. 개발 로드맵 및 관리
버전 관리: Git을 활용한 코드 버전 관리.
작업을 진행할 때 아래와 같이 한다.
파일에 현재 진행사항 및 업데이트 내용을 doc/ 폴더에 있는 다음 파일에 기록한다.
- 20250718_작업할내용.txt: 현재 진행사항
- 추가 내용.txt: 필요한 내용이 있을 경우 추가되는 파일

### 사용법
시스템 설치 및 사용 방법에 대한 상세 내용은 추후 업데이트 예정입니다.

### 로드맵
본 프로젝트의 개발 로드맵은 '6. 개발 순서 (제안)' 센션을 따릅니다. 각 단계별 상세 일정은 추후 확정됩니다.

### 목표
*   **단기 목표**: 키움증권 REST API 연동 모듈 개발 완료 및 미국/국내 주식 데이터 수집 및 분석 모듈의 초기 버전 구현.
*   **장기 목표**: 안정적인 자동매매 로직 구현 및 사용자 친화적인 웹 인터페이스 완성. 모의 투자를 통한 시스템 검증 및 실투자 적용 준비.

### 현재 진행 상황
*   **환경 설정**: Python 및 PHP 개발 환경 구축, 키움증권 REST API 연동 준비 (진행 중).
*   **API 연동 모듈 개발**: 키움증권 REST API를 이용한 계좌 조회, 주문, 시세 조회 등 기본 기능 모듈화 (진행 중).
*   **데이터 수집 및 분석 모듈 개발**: 초기 단계 (예정).
*   **매매 전략 로직 구현**: 초기 단계 (예정).
*   **웹 인터페이스 기본 구조 개발 (PHP)**: 초기 단계 (예정).
*   **데이터 연동 및 실시간 갱신**: 초기 단계 (예정).
*   **UI/UX 개선 및 추가 기능 구현**: 초기 단계 (예정).
*   **테스트 및 디버깅**: 초기 단계 (예정).
*   **문서화**: 현재 진행 중.


6. 개발 순서 (제안)
환경 설정: Python 및 PHP 개발 환경 구축, 키움증권 REST API 연동 준비.

API 연동 모듈 개발: 키움증권 REST API를 이용한 계좌 조회, 주문, 시세 조회 등 기본 기능 모듈화 (Python).

데이터 수집 및 분석 모듈 개발:

미국 주식 상승률 웹 스크래핑/API 연동 및 테마/뉴스 검색.

국내 주식 관심종목 데이터 연동 및 테마/뉴스 검색.

일봉/분봉 차트 데이터 수집 및 가공.

매매 전략 로직 구현:

급등주 검색 로직 구현.

5일/10일 이동평균선 이탈 여부 확인 로직 구현.

매도 물량 기반 매매 로직 구현.

손절/익절 로직 구현.

웹 인터페이스 기본 구조 개발 (PHP):

자동매매 제어 기능 (시작/일시정지/중지) 구현.

데이터를 표시할 기본 웹 페이지 레이아웃 구성.

데이터 연동 및 실시간 갱신:

Python 로직에서 처리된 데이터를 PHP 웹으로 전달 및 표시.

웹 페이지 자동 갱신 기능 구현.

UI/UX 개선 및 추가 기능 구현:

차트 시각화 (일봉/분봉 차트).

미국/국내 주식 정보 표시 UI 개선.

매매 현황 상세 표시.

손실 설정 기능 UI 구현.

테스트 및 디버깅: 모의 투자를 통한 시스템 전체 테스트 및 버그 수정.

문서화: 사용 설명서, 로드맵 등 문서 작성 및 업데이트.

## 배포 및 동작화 테스트
## 최종 배포 자동화 테스트